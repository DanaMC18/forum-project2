
<a href="/topics"> Back to Topics </a>

<div id="topic-container">


  <h2><%= @topic.title %></h2>

  <a href="/users/<%=@topic.user_id%>"> <%= @topic.user.username %> </a>


  <div id="topic-content">
    
    <p> <%= @topic.content %> </p>


    <!-- EDIT TOPIC -->
    <!-- only seen by user who created it -->
    <% if @topic.user_id == session[:user_id] %>
      <a href="/topics/<%= @topic.id %>/edit"> Edit </a>
    <% end %>


  </div> <!--content-->




  <!-- COMMENTS -->
  <!-- Need if/else because .each does not work if there is only one comment -->
  <div id="comments-container">

    <h3>Comments:</h3>


    <% if @comment %>

      <div class="comment-content">

        <a href="/users/<%=@comment.user_id%>"> <%= @comment.user.username %>: </a>
        <p><strong> At: </strong> <%= @comment.pretty_time %> </p>
        <p> <%= @comment.content %> </p>
        <p><strong> Likes: </strong> <%= @comment.like_count %> </p>


        <!-- LIKE COMMENT BUTTON -->
        <!-- Only logged in users can like-->
         <% if @user %>

            <form method="post" action="/topics/<%= @topic.id %>/comments/<%= @comment.id %>/likes">
            <button>Like</button>
            </form>

          <% end %>


          <!-- EDIT AND DELETE COMMENT BUTTONS -->
          <!-- only seen by user who created comment-->
          <% if @comment.user_id == session[:user_id] %>
            <br>
            <a href="/topics/<%= @topic.id %>/comments/<%= @comment.id %>/edit"> Edit </a>
            <br>

            <form method="post" action="/topics/<%= @topic.id %>/comments/<%= @comment.id %>">
              <input type="hidden" name="_method" value="delete">
              <button> Delete Comment </button>
            </form>

            <br>

          <% end %>

        <br>

      </div> <!--comment content -->

    <% else %>

      <% @comments.each do |comment| %>

        <div class="comment-content">

          <a href="/users/<%=comment.user_id%>"> <%= comment.user.username %>: </a>
          <p><strong> At: </strong> <%= comment.pretty_time %> </p>
          <p> <%= comment.content %> </p>
          <p><strong> Likes: </strong> <%= comment.like_count %> </p>


          <!-- LIKE COMMENT -->
          <!-- Only logged in users can like-->
          <% if @user %>

            <form method="post" action="/topics/<%= @topic.id %>/comments/<%= comment.id %>/likes">
            <button>Like</button>
            </form>

          <% end %>


          <!-- EDIT AND DELETE COMMENT BUTTONS -->
          <!-- only seen by user who created comment-->
          <% if comment.user_id == session[:user_id] %>
            <br>
            <a href="/topics/<%= @topic.id %>/comments/<%= comment.id %>/edit"> Edit </a>
            <br>

            <form method="post" action="/topics/<%= @topic.id %>/comments/<%= comment.id %>">
              <input type="hidden" name="_method" value="delete">
              <button> Delete Comment </button>
            </form>
            
            <br>

          <% end %>

          <br>

        </div> <!-- comment content -->

      <% end %> <!-- .each -->

    <% end %> <!-- if/else -->

    


    <!-- NEW COMMENT FORM  -->
    <!-- Seen only by someone logged in -->
    <% if @user %>
     
      <h3> Add Comment: </h3>

      <form method="POST" action="/topics/<%= @topic.id %>/comments/new">

        <p> Write Your Post Below </p>
        <textarea name="content" cols="100" rows="10"></textarea>
        <br>
        <input type="submit" value="Add Comment">

      </form>

    <% else %>

      <h3> Want to join the conversation? <a href="/"> Log In! </a> </h3>

    <% end %>


  </div> <!--comments-container-->

</div><!--topic-container-->














